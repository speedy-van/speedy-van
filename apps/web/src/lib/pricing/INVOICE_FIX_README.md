# Speedy Van - Invoice Download Fix

## ๐ **ุงููุดููุฉ ุงูุฃุตููุฉ**

ูุงูุช ุงููุงุชูุฑุฉ ุชุธูุฑ ูุงุฑุบุฉ ุจุนุฏ ุงูุฏูุน ูุฃู ุงููุธุงู ูุงู ููุดุฆ ููู ูุตู ุจุฏูุงู ูู ููู PDF ุญูููู.

## โ **ุงูุญู ุงููุทุจู**

### **1. ุชุซุจูุช ููุชุจุฉ jsPDF**

```bash
npm install jspdf
```

### **2. ุชุญุฏูุซ ุตูุญุฉ ูุฌุงุญ ุงูุฏูุน**

- **ุงูููู:** `src/app/booking/success/page.tsx`
- **ุงูุชุบููุฑ:** ุงุณุชุจุฏุงู ุฅูุดุงุก ุงููุต ุจุฅูุดุงุก PDF ุญูููู
- **ุงูููุฒุฉ:** ูุงุชูุฑุฉ PDF ุงุญุชุฑุงููุฉ ูุน ุชุฎุทูุท ููุงุณุจ

### **3. ุฅูุดุงุก ุตูุญุฉ ุงุฎุชุจุงุฑ**

- **ุงูููู:** `src/app/test-invoice-download/page.tsx`
- **ุงููุธููุฉ:** ุงุฎุชุจุงุฑ ุชุญููู ุงููุงุชูุฑุฉ ุจุดูู ูููุตู
- **ุงูููุฒุงุช:** ุงุฎุชุจุงุฑ ูุงูู + ุงุฎุชุจุงุฑ ูุจุงุดุฑ ูู jsPDF

## ๐งฎ **ููููุฉ ุนูู ุงููุธุงู ุงูุฌุฏูุฏ**

### **ุงูุฎุทูุฉ 1: ุงุณุชุฏุนุงุก API**

```typescript
const response = await fetch('/api/invoice/generate', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    bookingId: 'SV12345678',
    amount: 150.0,
    customerData: {
      /* ... */
    },
    bookingDetails: {
      /* ... */
    },
  }),
});
```

### **ุงูุฎุทูุฉ 2: ุฅูุดุงุก PDF**

```typescript
const pdf = new jsPDF();
// ุฅุถุงูุฉ ุงููุญุชูู
pdf.text('๐ SPEEDY VAN LTD', 20, 20);
pdf.text('INVOICE', pageWidth / 2 - 20, 35);
// ... ุงููุฒูุฏ ูู ุงููุญุชูู
```

### **ุงูุฎุทูุฉ 3: ุชุญููู ุงูููู**

```typescript
pdf.save('invoice-SV12345678.pdf');
```

## ๐ **ูุญุชูู ุงููุงุชูุฑุฉ**

### **ุงูุฑุฃุณ:**

- ุดุนุงุฑ ุงูุดุฑูุฉ ูุงุณููุง
- ุงูุนููุงู ูุงูุงุชุตุงู
- ุฑูู ุงููุงุชูุฑุฉ ูุงูุชุงุฑูุฎ

### **ูุนูููุงุช ุงูุนููู:**

- ุงูุงุณู ูุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ุงููุงุชู ูุงูุนููุงู

### **ุชูุงุตูู ุงูุฎุฏูุฉ:**

- ูุตู ุงูุฎุฏูุฉ
- ุงููููุฉ ูุงูุณุนุฑ
- ุงูุฅุฌูุงูู

### **ููุฎุต ุงูุฏูุน:**

- ุงููุจูุบ ุงููุฑุนู
- VAT (20%)
- ุงูุฅุฌูุงูู ุงูููุงุฆู

### **ูุนูููุงุช ุงูุฏูุน:**

- ุทุฑููุฉ ุงูุฏูุน
- ุญุงูุฉ ุงูุฏูุน
- ุฑูู ุงููุนุงููุฉ
- ุชุงุฑูุฎ ุงูุฏูุน

### **ุงูุดุฑูุท ูุงูุฃุญูุงู:**

- ุดุฑูุท ุงูุฏูุน
- ุณูุงุณุฉ ุงูุฅูุบุงุก
- ูุนูููุงุช ุฅุถุงููุฉ

## ๐งช **ุงุฎุชุจุงุฑ ุงููุธุงู**

### **1. ุงุฎุชุจุงุฑ ูุงูู:**

- ุงูุชูู ุฅูู `/test-invoice-download`
- ุฃุฏุฎู ุฑูู ุงูุญุฌุฒ ูุงููุจูุบ
- ุงุถุบุท "Test Full Invoice Download"
- ุชุญูู ูู ุชุญููู ููู PDF

### **2. ุงุฎุชุจุงุฑ ูุจุงุดุฑ:**

- ุงุถุบุท "Test Direct PDF Generation"
- ุชุญูู ูู ุฅูุดุงุก ููู PDF ุจุณูุท

### **3. ุงุฎุชุจุงุฑ ูู ุตูุญุฉ ุงููุฌุงุญ:**

- ุฃููู ุนูููุฉ ุญุฌุฒ
- ุงูุชูู ุฅูู ุตูุญุฉ ุงููุฌุงุญ
- ุงุถุบุท "Download Invoice (PDF)"

## ๐ **ุงููุชุงุฆุฌ ุงููุชููุนุฉ**

### **โ ูุฌุญ ุงูุงุฎุชุจุงุฑ:**

- ุชุญููู ููู PDF ุญูููู
- ูุญุชูู ุงุญุชุฑุงูู ูููุธู
- ูุนูููุงุช ูุงููุฉ ูุฏูููุฉ
- ุชุฎุทูุท ููุงุณุจ ููุทุจุงุนุฉ

### **โ ูุดู ุงูุงุฎุชุจุงุฑ:**

- ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ
- ุชูุงุตูู ุงููุดููุฉ
- ุงูุชุฑุงุญุงุช ููุญู

## ๐ง **ุงููููุงุช ุงููุญุฏุซุฉ**

1. **`src/app/booking/success/page.tsx`**
   - ุฅุถุงูุฉ `import jsPDF from 'jspdf'`
   - ุชุญุฏูุซ `downloadInvoice()` function
   - ุฅุถุงูุฉ `generatePDFInvoice()` function

2. **`src/app/test-invoice-download/page.tsx`** (ุฌุฏูุฏ)
   - ุตูุญุฉ ุงุฎุชุจุงุฑ ุดุงููุฉ
   - ุงุฎุชุจุงุฑ API + PDF generation
   - ุนุฑุถ ุงููุชุงุฆุฌ ูุงูุชูุงุตูู

3. **`src/app/test-stripe-integration/page.tsx`**
   - ุฅุถุงูุฉ ุฑุงุจุท ูุตูุญุฉ ุงุฎุชุจุงุฑ PDF

## ๐ฆ **ุงูููุชุจุงุช ุงููุทููุจุฉ**

```json
{
  "dependencies": {
    "jspdf": "^2.5.1"
  }
}
```

## ๐ **ุงูุงุณุชุฎุฏุงู ูู ุงูุฅูุชุงุฌ**

### **1. ุฅุนุฏุงุฏ ุงูุจูุฆุฉ:**

```bash
npm install jspdf
```

### **2. ุชูุงูู ูุน ุงูุจูุงูุงุช ุงูุญููููุฉ:**

```typescript
// ุงุณุชุจุฏุงู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ ุจุจูุงูุงุช ุญููููุฉ
const customerData = {
  name: booking.customerName,
  email: booking.customerEmail,
  phone: booking.customerPhone,
  address: booking.customerAddress,
};
```

### **3. ุชุฎุตูุต ุงูุชุตููู:**

```typescript
// ุฅุถุงูุฉ ุดุนุงุฑ ุงูุดุฑูุฉ
pdf.addImage(logoData, 'PNG', 20, 20, 40, 20);

// ุชุฎุตูุต ุงูุฃููุงู ูุงูุฎุทูุท
pdf.setTextColor(0, 0, 255); // ุฃุฒุฑู
pdf.setFontSize(16);
```

## ๐ **ุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ**

### **ุงูููุฒุงุช ุงูููุชุฑุญุฉ:**

- **ุฅุถุงูุฉ ุดุนุงุฑ ุงูุดุฑูุฉ** ูู ุงููุงุชูุฑุฉ
- **ุชุฎุตูุต ุงูุฃููุงู** ุญุณุจ ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ
- **ุฅุถุงูุฉ QR code** ูููุนูููุงุช
- **ุฏุนู ูุชุนุฏุฏ ุงููุบุงุช** (ุนุฑุจู/ุฅูุฌููุฒู)
- **ุฅุฑุณุงู ุงููุงุชูุฑุฉ ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู**
- **ุชุฎุฒูู ุงูููุงุชูุฑ** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### **ุงูุชุญุณููุงุช ุงูุชูููุฉ:**

- **ุชุญุณูู ุงูุฃุฏุงุก** ููููุงุชูุฑ ุงููุจูุฑุฉ
- **ุฅุถุงูุฉ ุชูููุน ุฑููู**
- **ุฏุนู ุงูุชูููุน ุงูุฅููุชุฑููู**
- **ุชูุงูู ูุน ุฃูุธูุฉ ุงููุญุงุณุจุฉ**

## ๐ **ุงูุฏุนู**

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:

1. ุชุญูู ูู ุชุซุจูุช ููุชุจุฉ jsPDF
2. ุชุฃูุฏ ูู ุตุญุฉ ุจูุงูุงุช API
3. ุฑุงุฌุน console ููุฑุณุงุฆู
4. ุงุฎุชุจุฑ ุนูู ุตูุญุฉ `/test-invoice-download`

---

**ุชู ุงูุฅุตูุงุญ ูู:** ููุงูุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 2.1 - Fixed Invoice Download
