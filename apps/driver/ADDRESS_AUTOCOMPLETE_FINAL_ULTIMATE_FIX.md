# ๐ง ุงูุฅุตูุงุญ ุงูููุงุฆู ุงููุทูู ุงูููุงุฆู ููุดููุฉ ุงูููุฑ ุงููุฒุฏูุฌ ูู AddressAutocomplete

## ุงููุดููุฉ ุงููุณุชูุฑุฉ

ุจุนุฏ ุฌููุน ุงูุฅุตูุงุญุงุช ุงูุณุงุจูุฉุ ูุง ุชุฒุงู ูุดููุฉ ุงูููุฑ ุงููุฒุฏูุฌ ููุฌูุฏุฉ. ุงููุดููุฉ ุชููู ูู ุฃู `useState` ูุง ูุนูู ุจุดูู ููุฑู ุจุณุจุจ React's state batching.

## ุณุจุจ ุงููุดููุฉ ุงูุฌุฐุฑู

ุงููุดููุฉ ูู ุงุณุชุฎุฏุงู `useState` ูุชุชุจุน ุญุงูุฉ ุงูุงุฎุชูุงุฑ:

- `useState` ูุง ูุชู ุชุญุฏูุซู ููุฑุงู
- React ูููู ุจู batching ููู state updates
- ูุฐุง ูุคุฏู ุฅูู ุนุฏู ุนูู ูุญุต `isSelecting` ุจุดูู ุตุญูุญ

## ุงูุฅุตูุงุญ ุงูููุงุฆู ุงููุทูู

### 1. ุงุณุชุจุฏุงู useState ุจู useRef

**ูุจู ุงูุฅุตูุงุญ:**

```typescript
const [isSelecting, setIsSelecting] = React.useState(false);
```

**ุจุนุฏ ุงูุฅุตูุงุญ:**

```typescript
const isSelectingRef = React.useRef(false);
```

### 2. ุชุญุฏูุซ ุฌููุน ุงููุฑุงุฌุน

**ูุจู ุงูุฅุตูุงุญ:**

```typescript
const selectItem = (idx: number) => {
  const item = items[idx];
  if (!item || isSelecting) return; // Prevent double selection

  setIsSelecting(true);
  // ... rest of the function

  // Reset selection flag after a short delay
  setTimeout(() => setIsSelecting(false), 100);
};
```

**ุจุนุฏ ุงูุฅุตูุงุญ:**

```typescript
const selectItem = (idx: number) => {
  const item = items[idx];
  if (!item || isSelectingRef.current) return; // Prevent double selection

  isSelectingRef.current = true;
  // ... rest of the function

  // Reset selection flag after a short delay
  setTimeout(() => {
    isSelectingRef.current = false;
  }, 100);
};
```

### 3. ุชุญุฏูุซ ูุนุงูุฌุงุช ุงูุฃุญุฏุงุซ

**ูุจู ุงูุฅุตูุงุญ:**

```typescript
onFocus={() => {
  if (items.length && !isSelecting) {
    setOpen(true);
  }
}}
onBlur={() => {
  if (!isSelecting) {
    setTimeout(() => setOpen(false), 150);
  }
}}
```

**ุจุนุฏ ุงูุฅุตูุงุญ:**

```typescript
onFocus={() => {
  if (items.length && !isSelectingRef.current) {
    setOpen(true);
  }
}}
onBlur={() => {
  if (!isSelectingRef.current) {
    setTimeout(() => setOpen(false), 150);
  }
}}
```

### 4. ุฅุถุงูุฉ ุญูุงูุฉ ุฅุถุงููุฉ

**ุฅุถุงูุฉ ุญูุงูุฉ ุฅุถุงููุฉ ูู selectItem:**

```typescript
// Prevent immediate reopening by setting a flag
isSelectingRef.current = true;
```

## ุงููุฒุงูุง ุงููุญููุฉ ูู ุงูุฅุตูุงุญ ุงูููุงุฆู

### โ **ุงุณุชุฌุงุจุฉ ููุฑูุฉ:**

- `useRef` ูุชู ุชุญุฏูุซู ููุฑุงู
- ูุง ููุฌุฏ ุชุฃุฎูุฑ ูู ูุญุต ุญุงูุฉ ุงูุงุฎุชูุงุฑ
- ููุน ุงูุงุฎุชูุงุฑ ุงููุฒุฏูุฌ ูุนูู ุจุดูู ุตุญูุญ

### โ **ุงุณุชูุฑุงุฑ ุงููููู:**

- ุชุฌูุจ React's state batching issues
- ูุนุงูุฌุฉ ุฃูุถู ููุฃุญุฏุงุซ ุงููุชุฒุงููุฉ
- ููุฏ ุฃูุซุฑ ููุซูููุฉ

### โ **ุชุญุณูู ุงูุฃุฏุงุก:**

- `useRef` ูุง ูุณุจุจ re-renders
- ุชูููู ุนุฏุฏ ุนูููุงุช ุงูุชุญุฏูุซ
- ุฃุฏุงุก ุฃูุถู

## ููููุฉ ุนูู ุงูุฅุตูุงุญ

### ๐ **ุชุฏูู ุงูุฃุญุฏุงุซ ุงููุญุณู:**

1. **ุงูููุฑ ุนูู ุงูุนูุตุฑ:**
   - `onMouseDown` ูุชู ุงุณุชุฏุนุงุคู
   - `isSelectingRef.current = true` (ููุฑู)
   - `selectItem` ูุชู ุงุณุชุฏุนุงุคู ูุฑุฉ ูุงุญุฏุฉ ููุท

2. **ุฃุซูุงุก ุงูุงุฎุชูุงุฑ:**
   - `onBlur` ูุง ูุบูู ุงููุงุฆูุฉ (ูุฃู `isSelectingRef.current = true`)
   - `onFocus` ูุง ูุนูุฏ ูุชุญ ุงููุงุฆูุฉ (ูุฃู `isSelectingRef.current = true`)

3. **ุจุนุฏ ุงูุงุฎุชูุงุฑ:**
   - `isSelectingRef.current = false` ุจุนุฏ 100ms
   - ุงููููู ูุนูุฏ ุฅูู ุญุงูุชู ุงูุทุจูุนูุฉ

## ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. **ุงุฎุชุจุงุฑ ุงูููุฑ ุงููุฒุฏูุฌ:**

1. ุงูุชูู ุฅูู `/booking`
2. ุงูุชุจ ุนููุงู ูู ุญูู ุงูุจุญุซ
3. ุงููุฑ ูุฑุฉ ูุงุญุฏุฉ ุนูู ุนููุงู ูู ุงูุงูุชุฑุงุญุงุช
4. ุชุญูู ูู ุฃู `selectItem` ูุชู ุงุณุชุฏุนุงุคู ูุฑุฉ ูุงุญุฏุฉ ููุท ูู Console

### 2. **ุงุฎุชุจุงุฑ ุนุฏู ุฅุนุงุฏุฉ ุงููุชุญ:**

1. ุงุฎุชุฑ ุนููุงู ูู ุงูุงูุชุฑุงุญุงุช
2. ุชุญูู ูู ุนุฏู ุฅุนุงุฏุฉ ูุชุญ ุงููุงุฆูุฉ
3. ุชุญูู ูู ุนุฏู ุธููุฑ ุฑุณุงุฆู Console ููุฑุฑุฉ

### 3. **ุงุฎุชุจุงุฑ ุงูุชููู ุจุงูููุจูุฑุฏ:**

1. ุงุณุชุฎุฏู ุฃุฒุฑุงุฑ ุงูุฃุณูู ููุชููู
2. ุงุถุบุท Enter ูุงุฎุชูุงุฑ ุงูุนููุงู
3. ุชุญูู ูู ุนูู ุงูุชููู ุจุดูู ุตุญูุญ

## ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ

ุจุนุฏ ุชุทุจูู ูุฐุง ุงูุฅุตูุงุญ ุงูููุงุฆู:

1. โ **ุงูููุฑ ูุฑุฉ ูุงุญุฏุฉ ูุงููุฉ** ูุงุฎุชูุงุฑ ุงูุนููุงู
2. โ **ูุง ูุชู ุงุณุชุฏุนุงุก selectItem ูุฑุชูู**
3. โ **ูุง ุชูุฌุฏ ุฑุณุงุฆู Console ููุฑุฑุฉ**
4. โ **ูุง ูุชู ุฅุนุงุฏุฉ ูุชุญ ุงููุงุฆูุฉ ุจุนุฏ ุงูุงุฎุชูุงุฑ**
5. โ **ุงูุชููู ุจุงูููุจูุฑุฏ ูุนูู ุจุดูู ุตุญูุญ**
6. โ **ุงุณุชุฌุงุจุฉ ููุฑูุฉ ููุฃุญุฏุงุซ**
7. โ **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ ููุณุชูุฑุฉ**

## ููุงุญุธุงุช ุชูููุฉ

- ุงุณุชุฎุฏุงู `useRef` ุจุฏูุงู ูู `useState` ูุถูู ุงูุงุณุชุฌุงุจุฉ ุงูููุฑูุฉ
- `useRef` ูุง ูุณุจุจ re-renders ููุง ูุญุณู ุงูุฃุฏุงุก
- ูุฐุง ุงูุฅุตูุงุญ ูุญู ูุดููุฉ React's state batching
- ุงูุญูุงูุฉ ุงูุฅุถุงููุฉ ุชููุน ุฅุนุงุฏุฉ ูุชุญ ุงููุงุฆูุฉ

## ุงูุฎูุงุตุฉ

ูุฐุง ุงูุฅุตูุงุญ ุงูููุงุฆู ูุญู ูุดููุฉ ุงูููุฑ ุงููุฒุฏูุฌ ุจุดูู ุฌุฐุฑู ูู ุฎูุงู:

- ุงุณุชุฎุฏุงู `useRef` ููุงุณุชุฌุงุจุฉ ุงูููุฑูุฉ
- ุชุฌูุจ React's state batching issues
- ุฅุถุงูุฉ ุญูุงูุฉ ุฅุถุงููุฉ ุถุฏ ุฅุนุงุฏุฉ ุงููุชุญ
- ุถูุงู ุงุณุชูุฑุงุฑ ุงููููู

ุงูุขู `AddressAutocomplete` ูุนูู ุจุดูู ูุซุงูู ูุน ุงูููุฑ ูุฑุฉ ูุงุญุฏุฉ ููุท! ๐
